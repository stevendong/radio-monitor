# 本地测试推送功能

快速测试Server酱或PushPlus推送是否配置正确。

---

## 🚀 快速测试

### 方式一：Server酱测试

```bash
# 1. 设置Token
export NOTIFICATION_TOKEN="你的Server酱SendKey"
export NOTIFICATION_TYPE="serverchan"

# 2. 运行测试
node test_notification.js
```

### 方式二：PushPlus测试

```bash
# 1. 设置Token
export NOTIFICATION_TOKEN="你的PushPlus Token"
export NOTIFICATION_TYPE="pushplus"

# 2. 运行测试
node test_notification.js
```

---

## 📱 获取Token

### Server酱（推荐）

1. 访问：https://sct.ftqq.com/
2. 微信扫码登录
3. 关注"方糖服务号"
4. 复制SendKey（格式：`SCT123456xxxxx`）

### PushPlus

1. 访问：https://www.pushplus.plus/
2. 微信扫码登录
3. 进入「发送消息」页面
4. 复制Token

---

## 🧪 测试内容

脚本会发送2条测试通知：

**测试1：** 单条考试通知（广州B类考试）
**测试2：** 多条考试通知（广州B类 + 深圳A类）

如果微信收到推送消息，说明配置正确！

---

## ✅ 预期结果

### 成功示例

```
======================================================================
📡 本地推送测试工具
======================================================================

📋 配置信息:
   通知类型: serverchan
   Token: SCT123456...

======================================================================
📝 推送内容预览:
======================================================================

标题:
🔔 发现 2 个新考试

内容:
📻 无线电考试监控

发现 2 个符合条件的考试：
...

======================================================================

🧪 测试 1: 发送单条考试通知...

📤 准备推送 1 条考试通知...
✅ Server酱推送成功

✅ 单条通知发送成功！请检查微信是否收到消息

----------------------------------------------------------------------

⏳ 等待3秒后发送第二条测试...

🧪 测试 2: 发送多条考试通知...

📤 准备推送 2 条考试通知...
✅ Server酱推送成功

✅ 多条通知发送成功！请检查微信是否收到消息

======================================================================

✅ 测试完成！

如果收到微信推送，说明配置正确！
======================================================================
```

---

## 🐛 常见问题

### Q: 显示"❌ Server酱推送失败: [AUTH]错误的Key"

**原因：** Token不正确或已失效

**解决：**
1. 重新访问 https://sct.ftqq.com/ 检查SendKey
2. 确认Token没有多余空格
3. 重新设置环境变量

### Q: 显示"❌ PushPlus推送失败: 请求错误"

**原因：** Token不正确

**解决：**
1. 访问 https://www.pushplus.plus/push
2. 检查Token是否正确
3. 确认微信已绑定

### Q: 提示成功但没收到微信消息

**Server酱：**
- 检查是否关注了"方糖服务号"公众号
- 查看公众号是否被屏蔽

**PushPlus：**
- 检查微信是否已绑定
- 查看PushPlus官网的消息记录

---

## 💡 测试完成后

如果测试成功，你可以：

1. **将Token配置到GitHub：**
   - Settings → Secrets → 添加 `NOTIFICATION_TOKEN`
   - Settings → Variables → 添加 `NOTIFICATION_TYPE`

2. **删除本地测试文件（可选）：**
   ```bash
   rm test_notification.js
   ```

3. **清空环境变量：**
   ```bash
   unset NOTIFICATION_TOKEN
   unset NOTIFICATION_TYPE
   ```

---

**测试成功后就可以部署到GitHub了！** 🎉
